"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2509],{6464:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-8daa1a0e",path:"/",title:"Introduction",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Installation",slug:"installation",children:[]},{level:2,title:"Quick start",slug:"quick-start",children:[{level:3,title:"Register Dev Panel",slug:"register-dev-panel",children:[]},{level:3,title:"DI services",slug:"di-services",children:[]},{level:3,title:"Setting mode",slug:"setting-mode",children:[]},{level:3,title:"Environment variables",slug:"environment-variables",children:[]}]}],filePathRelative:"README.md",git:{updatedTime:1685967966e3,contributors:[{name:"Anton",email:"a.shumansky@gmail.com",commits:3},{name:"Krasimir Ivanov",email:"krasimir.ivanov@coretrix.com",commits:1}]}}},1878:(n,s,a)=>{a.r(s),a.d(s,{default:()=>N});var e=a(6252);const t=(0,e._)("h1",{id:"introduction",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#introduction","aria-hidden":"true"},"#"),(0,e.Uk)(" Introduction")],-1),p=(0,e.Uk)("Hitrix is a web framework written in Go (Golang) and support Graphql and REST api. It is based on top of "),o={href:"https://gqlgen.com/%5D",target:"_blank",rel:"noopener noreferrer"},c=(0,e.Uk)("Gqlgen"),i=(0,e.Uk)(" and "),l={href:"https://github.com/gin-gonic/gin",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Uk)("Gin Framework"),u=(0,e._)("h4",{id:"why-to-choose-hitrix",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#why-to-choose-hitrix","aria-hidden":"true"},"#"),(0,e.Uk)(" Why to choose Hitrix?")],-1),k=(0,e._)("p",null,"Hitrix is combination between high performance and speed of development. There are many build-in features and tools that save development time. Also this framework helps you from the day zero to start creating new features for your project. You don't need to spend time thinking about error log, db layer, caching, DI, structure, background jobs and so on. The only thing you need to do is to use Hitrix and deliver fast to the business",-1),d=(0,e._)("p",null,"Built-in features:",-1),b=(0,e.Uk)("It supports all features of "),m={href:"https://gqlgen.com/%5D",target:"_blank",rel:"noopener noreferrer"},g=(0,e.Uk)("Gqlgen"),h=(0,e.Uk)(" and "),v={href:"https://github.com/gin-gonic/gin",target:"_blank",rel:"noopener noreferrer"},f=(0,e.Uk)("Gin Framework"),y=(0,e.Uk)("Integrated with "),w={href:"https://github.com/latolukasz/beeorm",target:"_blank",rel:"noopener noreferrer"},q=(0,e.Uk)("ORM"),x=(0,e.Uk)("Follows "),_={href:"https://en.wikipedia.org/wiki/Dependency_injection",target:"_blank",rel:"noopener noreferrer"},I=(0,e.Uk)("Dependency injection"),D=(0,e.Uk)(" pattern"),S=(0,e._)("li",null,"Provides many DI services that makes your life easier. You can read more about them in our documentation",-1),R=(0,e.Uk)("Provides "),P={href:"https://github.com/coretrix/dev-frontend",target:"_blank",rel:"noopener noreferrer"},E=(0,e.Uk)("Dev panel"),G=(0,e.Uk)(" where you can monitor and manage your application(monitoring, error log, db alters redis status and so on)"),U=(0,e._)("li",null,[(0,e.Uk)("Other Features "),(0,e._)("ul",null,[(0,e._)("li",null,"Database Seeding"),(0,e._)("li",null,"Helpers"),(0,e._)("li",null,"Background scripts"),(0,e._)("li",null,"Validators"),(0,e._)("li",null,"Integration tests"),(0,e._)("li",null,"and so on...")])],-1),M=(0,e.uE)('<h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>go get -u github.com/coretrix/hitrix\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="quick-start" tabindex="-1"><a class="header-anchor" href="#quick-start" aria-hidden="true">#</a> Quick start</h2><ol><li>Run next command into your project&#39;s main folder and the graph structure will be created</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>go run github.com/99designs/gqlgen init\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ol start="2"><li>Create <code>cmd</code> folder into your project and file called <code>main.go</code></li></ol><p>Put the next code into the file:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main\n\n<span class="token keyword">import</span> <span class="token punctuation">(</span>\n\t<span class="token string">&quot;github.com/coretrix/hitrix&quot;</span>\n\t<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>\n\t\n\t<span class="token string">&quot;your-project/graph&quot;</span> <span class="token comment">//path you your graph</span>\n\t<span class="token string">&quot;your-project/graph/generated&quot;</span> <span class="token comment">//path you your graph generated folder</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\ts<span class="token punctuation">,</span> deferFunc <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>\n\t\t<span class="token string">&quot;app-name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;your secret&quot;</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">defer</span> <span class="token function">deferFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\ts<span class="token punctuation">.</span><span class="token function">RunServer</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span> generated<span class="token punctuation">.</span><span class="token function">NewExecutableSchema</span><span class="token punctuation">(</span>generated<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>Resolvers<span class="token punctuation">:</span> <span class="token operator">&amp;</span>graph<span class="token punctuation">.</span>Resolver<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token keyword">func</span><span class="token punctuation">(</span>ginEngine <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token comment">//here you can register all your middlewares</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>You are able register DI services in your <code>main.go</code> file in that way:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main\n\n<span class="token keyword">import</span> <span class="token punctuation">(</span>\n\t<span class="token string">&quot;github.com/coretrix/hitrix&quot;</span>\n\t<span class="token string">&quot;github.com/coretrix/hitrix/service/registry&quot;</span>\n\t<span class="token string">&quot;your-project/entity&quot;</span>\n\t<span class="token string">&quot;your-project/graph&quot;</span>\n\t<span class="token string">&quot;your-project/graph/generated&quot;</span>\n\t<span class="token string">&quot;github.com/coretrix/hitrix/pkg/middleware&quot;</span>\n\t<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>\n\t<span class="token string">&quot;github.com/coretrix/hitrix/service/component/app&quot;</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\ts<span class="token punctuation">,</span> deferFunc <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>\n\t\t<span class="token string">&quot;app-name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;your secret&quot;</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RegisterDIGlobalService</span><span class="token punctuation">(</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderErrorLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register redis error logger</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderConfigDirectory</span><span class="token punctuation">(</span><span class="token string">&quot;../config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register config service. As param you should point to the folder of your config file</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderOrmRegistry</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>Init<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register our ORM and pass function where we set some configurations </span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderOrmEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register our ORM engine for background processes</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderJWT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register JWT DI service</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span>NewSimpleManager<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register pasword DI service</span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RegisterDIRequestService</span><span class="token punctuation">(</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderOrmEngineForContext</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register our ORM engine per context used in foreground processes </span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RegisterRedisPools</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>app<span class="token punctuation">.</span>RedisPools<span class="token punctuation">{</span>Persistent<span class="token punctuation">:</span> <span class="token string">&quot;your pool here&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>\n    <span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">defer</span> <span class="token function">deferFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n\ts<span class="token punctuation">.</span><span class="token function">RunServer</span><span class="token punctuation">(</span><span class="token number">9999</span><span class="token punctuation">,</span> generated<span class="token punctuation">.</span><span class="token function">NewExecutableSchema</span><span class="token punctuation">(</span>generated<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>Resolvers<span class="token punctuation">:</span> <span class="token operator">&amp;</span>graph<span class="token punctuation">.</span>Resolver<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token keyword">func</span><span class="token punctuation">(</span>ginEngine <span class="token operator">*</span>gin<span class="token punctuation">.</span>Engine<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\tmiddleware<span class="token punctuation">.</span><span class="token function">Cors</span><span class="token punctuation">(</span>ginEngine<span class="token punctuation">)</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>Now I will explain the main.go file line by line</p><ol><li><p>We create <strong>New</strong> instance of Hitrix and pass app name and a secret that is used from our security services</p></li><li><p>We register some DI services</p><p>2.1. Global DI service for error logger. It will be used for error handler as well in case of panic If you register Slack error logger also it will send messages to slack channel</p><p>2.2. Global DI service that loads config file</p><p>2.3. Global DI service that initialize our ORM registry</p><p>2.4. Global DI ORM engine used in background processes</p><p>2.6. Global DI JWT service used by dev panel</p><p>2.7. Global DI Password service used by dev-panel</p><p>2.8. Request DI ORM engine used in foreground processes</p></li><li><p>We register redis pools. Those pools are used by different services as <code>authentication</code> service, <code>dev panel</code> and so on</p></li><li><p>We run the server on port <code>9999</code>, pass graphql resolver and as third param we pass all middlewares we need.<br> As you can see in our example we register only Cors middleware</p></li></ol>',12),O={id:"register-dev-panel",tabindex:"-1"},W=(0,e._)("a",{class:"header-anchor",href:"#register-dev-panel","aria-hidden":"true"},"#",-1),C=(0,e.Uk)(" Register "),A={href:"https://github.com/coretrix/dev-frontend",target:"_blank",rel:"noopener noreferrer"},F=(0,e.Uk)("Dev Panel"),T=(0,e.uE)('<p>If you want to use our dev panel and to be able to manage alters, error log, redis monitoring, redis stream and so on you should execute next steps:</p><h4 id="create-devpaneluserentity" tabindex="-1"><a class="header-anchor" href="#create-devpaneluserentity" aria-hidden="true">#</a> Create DevPanelUserEntity</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> entity\n\n<span class="token keyword">import</span> <span class="token punctuation">(</span>\n\t<span class="token string">&quot;github.com/latolukasz/beeorm&quot;</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">type</span> DevPanelUserEntity <span class="token keyword">struct</span> <span class="token punctuation">{</span>\n\tbeeorm<span class="token punctuation">.</span>ORM   <span class="token string">`orm:&quot;table=admin_users;redisCache&quot;`</span>\n\tID        <span class="token builtin">uint64</span>\n\tEmail     <span class="token builtin">string</span> <span class="token string">`orm:&quot;unique=Email&quot;`</span>\n\tPassword  <span class="token builtin">string</span>\n\n\tUserEmailIndex <span class="token operator">*</span>beeorm<span class="token punctuation">.</span>CachedQuery <span class="token string">`queryOne:&quot;:Email = ?&quot;`</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>DevPanelUserEntity<span class="token punctuation">)</span> <span class="token function">GetUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">return</span> e<span class="token punctuation">.</span>Email\n<span class="token punctuation">}</span>\n\n<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>DevPanelUserEntity<span class="token punctuation">)</span> <span class="token function">GetPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">return</span> e<span class="token punctuation">.</span>Password\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>After that you should register it to the <code>entity.Init</code> function</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> entity\n\n<span class="token keyword">import</span> <span class="token string">&quot;github.com/latolukasz/beeorm&quot;</span>\n\n<span class="token keyword">func</span> <span class="token function">Init</span><span class="token punctuation">(</span>registry <span class="token operator">*</span>beeorm<span class="token punctuation">.</span>Registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\tregistry<span class="token punctuation">.</span><span class="token function">RegisterEntity</span><span class="token punctuation">(</span>\n\t\t<span class="token operator">&amp;</span>DevPanelUserEntity<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Please execute this alter into your database</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code>\n<span class="token keyword">create</span> <span class="token keyword">table</span> dev_panel_users\n<span class="token punctuation">(</span>\n    ID       <span class="token keyword">bigint</span> <span class="token keyword">unsigned</span> <span class="token keyword">auto_increment</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>\n    Email    <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token boolean">null</span><span class="token punctuation">,</span>\n    Password <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token boolean">null</span><span class="token punctuation">,</span>\n    <span class="token keyword">constraint</span> Email <span class="token keyword">unique</span> <span class="token punctuation">(</span>Email<span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">charset</span> <span class="token operator">=</span> utf8mb4<span class="token punctuation">;</span>\n\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>After that you can make GET request to http://localhost:9999/dev/create-dev-panel-user/?username=contact@coretrix.com&amp;password=coretrix This will generate sql query that should be executed into your database to create new user for dev panel</p><h4 id="register-dev-panel-when-you-make-new-instance-of-hitrix-framework-in-your-main-go-file" tabindex="-1"><a class="header-anchor" href="#register-dev-panel-when-you-make-new-instance-of-hitrix-framework-in-your-main-go-file" aria-hidden="true">#</a> Register dev panel when you make new instance of hitrix framework in your <code>main.go</code> file</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>s<span class="token punctuation">,</span> deferFunc <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>\n\t\t<span class="token string">&quot;app-name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;your secret&quot;</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">RegisterDIGlobalService</span><span class="token punctuation">(</span>\n\t\tregistry<span class="token punctuation">.</span><span class="token function">ServiceProviderErrorLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//register redis error logger</span>\n\t\t<span class="token comment">//...</span>\n\t<span class="token punctuation">)</span><span class="token punctuation">.</span>\n    <span class="token function">RegisterDevPanel</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>entity<span class="token punctuation">.</span>DevPanelUserEntity<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> middleware<span class="token punctuation">.</span>Router<span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token comment">//register our dev-panel and pass the entity where we save admin users, the router and the third param is used for the redis stream pool if its used</span>\n    <span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="di-services" tabindex="-1"><a class="header-anchor" href="#di-services" aria-hidden="true">#</a> DI services</h3><p>We have two types of DI services - Global and Request services Global services are singletons created once for the whole application Request services are singletons created once per request</p><h4 id="calling-di-services" tabindex="-1"><a class="header-anchor" href="#calling-di-services" aria-hidden="true">#</a> Calling DI services</h4><p>If you want to access the registered DI services you can do in in that way:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>service<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access the app</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access config</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrmEngine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access global orm engine</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrmEngineForContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access reqeust orm engine</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">JWT</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access JWT</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Password</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//access JWT</span>\n<span class="token comment">//...and so on</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="register-new-di-global-service" tabindex="-1"><a class="header-anchor" href="#register-new-di-global-service" aria-hidden="true">#</a> Register new DI global service</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>\n<span class="token keyword">func</span> <span class="token function">ServiceProviderMyService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>ServiceProvider <span class="token punctuation">{</span>\n\t<span class="token keyword">return</span> <span class="token operator">&amp;</span>ServiceProvider<span class="token punctuation">{</span>\n\t\tName<span class="token punctuation">:</span>   <span class="token string">&quot;my_service&quot;</span><span class="token punctuation">,</span>\n\t\tBuild<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctn di<span class="token punctuation">.</span>Container<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t\t<span class="token keyword">return</span> <span class="token operator">&amp;</span>yourService<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>And you have to register <code>ServiceProviderMyService()</code> in your <code>main.go</code> file</p><p>Now you can access this service in your code using:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>\n    <span class="token string">&quot;github.com/coretrix/hitrix&quot;</span>\n<span class="token punctuation">)</span>\n\n<span class="token keyword">func</span> <span class="token function">SomeResolver</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\n    service<span class="token punctuation">.</span><span class="token function">HasService</span><span class="token punctuation">(</span><span class="token string">&quot;my_service&quot;</span><span class="token punctuation">)</span> <span class="token comment">// return true</span>\n    \n    <span class="token comment">// return error if Build function returned error</span>\n    myService<span class="token punctuation">,</span> has<span class="token punctuation">,</span> err <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">GetServiceSafe</span><span class="token punctuation">(</span><span class="token string">&quot;my_service&quot;</span><span class="token punctuation">)</span> \n    <span class="token comment">// will panic if Build function returns error</span>\n    myService<span class="token punctuation">,</span> has <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">GetServiceOptional</span><span class="token punctuation">(</span><span class="token string">&quot;my_service&quot;</span><span class="token punctuation">)</span> \n    <span class="token comment">// will panic if service is not registered or Build function returned errors</span>\n    myService <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">GetServiceRequired</span><span class="token punctuation">(</span><span class="token string">&quot;my_service&quot;</span><span class="token punctuation">)</span> \n\n    <span class="token comment">// if you registered service with field &quot;Global&quot; set to false (request service)</span>\n\n    myContextService<span class="token punctuation">,</span> has<span class="token punctuation">,</span> err <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">GetServiceForRequestSafe</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;my_service_request&quot;</span><span class="token punctuation">)</span>\n    myContextService<span class="token punctuation">,</span> has <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">GetServiceForRequestOptional</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;my_service_request&quot;</span><span class="token punctuation">)</span> \n    myContextService <span class="token operator">:=</span> hitrix<span class="token punctuation">.</span><span class="token function">GetServiceForRequestRequired</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;my_service_request&quot;</span><span class="token punctuation">)</span> \n<span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>It&#39;s a good practice to define one object to return all available services:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> my_package\n<span class="token keyword">import</span> <span class="token punctuation">(</span>\n    <span class="token string">&quot;github.com/coretrix/hitrix&quot;</span>\n<span class="token punctuation">)</span>\n\n\n\n<span class="token keyword">func</span> <span class="token function">MyService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> MyService <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> service<span class="token punctuation">.</span><span class="token function">GetServiceRequired</span><span class="token punctuation">(</span><span class="token string">&quot;service_key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>MyService<span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="setting-mode" tabindex="-1"><a class="header-anchor" href="#setting-mode" aria-hidden="true">#</a> Setting mode</h3><h4 id="app-mode-environment-variable" tabindex="-1"><a class="header-anchor" href="#app-mode-environment-variable" aria-hidden="true">#</a> APP_MODE environment variable</h4><p>You can define hitrix mode using special environment variable &quot;<strong>APP_MODE</strong>&quot;.</p><p>Hitrix provides by default four modes:</p><ul><li><strong>hitrix.ModeLocal - local</strong><ul><li>should be used on local development machine (developer laptop)</li><li>errors and stack trace is printed directly to system console</li><li>log level is set to Debug level</li><li>log is formatted using human friendly console text formatter</li><li>Gin Framework is running in GinDebug mode</li></ul></li><li><strong>hitrix.ModeTest - test</strong><ul><li>should be used when you run your application tests</li></ul></li><li><strong>hitrix.ModeDev - dev</strong><ul><li>should be used on your dev server</li></ul></li><li><strong>hitrix.ModeDemo - demo</strong><ul><li>should be used on your demo server</li></ul></li><li><strong>hitrix.ModeProd - prod</strong><ul><li>errors and stack trace is printed only using Log</li><li>log level is set to Warn level</li><li>log is formatted using json formatter</li></ul></li></ul><p>Mode is just a string. You can define any name you want. Remember that every mode that you create follows <strong>hitrix.ModeProd</strong> rules explained above.</p><p>In code you can easly check current mode using one of these methods:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>service<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Mode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsInLocalMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsInProdMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nservice<span class="token punctuation">.</span><span class="token function">DI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">IsInMode</span><span class="token punctuation">(</span><span class="token string">&quot;my_mode&quot;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="environment-variables" tabindex="-1"><a class="header-anchor" href="#environment-variables" aria-hidden="true">#</a> Environment variables</h3><h4 id="app-folder-environment-variable" tabindex="-1"><a class="header-anchor" href="#app-folder-environment-variable" aria-hidden="true">#</a> APP_FOLDER environment variable</h4><p>There are another important environment variable called <code>environment</code> You can set path to your app folder for your demo, prod or any other environment</p>',33),j={},N=(0,a(3744).Z)(j,[["render",function(n,s){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t,(0,e._)("p",null,[p,(0,e._)("a",o,[c,(0,e.Wm)(a)]),i,(0,e._)("a",l,[r,(0,e.Wm)(a)])]),u,k,d,(0,e._)("ul",null,[(0,e._)("li",null,[b,(0,e._)("a",m,[g,(0,e.Wm)(a)]),h,(0,e._)("a",v,[f,(0,e.Wm)(a)])]),(0,e._)("li",null,[y,(0,e._)("a",w,[q,(0,e.Wm)(a)])]),(0,e._)("li",null,[x,(0,e._)("a",_,[I,(0,e.Wm)(a)]),D]),S,(0,e._)("li",null,[R,(0,e._)("a",P,[E,(0,e.Wm)(a)]),G]),U]),M,(0,e._)("h3",O,[W,C,(0,e._)("a",A,[F,(0,e.Wm)(a)])]),T],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{for(const[a,e]of s)n[a]=e;return n}}}]);